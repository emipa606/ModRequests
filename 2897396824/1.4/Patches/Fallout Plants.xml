<?xml version="1.0" encoding="utf-8" ?>
<Patch>

    <Operation Class="PatchOperationFindMod">
        <mods>
            <li>Fallout Plants</li>
        </mods>
		<match Class="PatchOperationSequence">
			<operations>

				<!-- Undo Fallout VCE patches -->
		       	<li Class="PatchOperationReplace">
			    	<xpath>/Defs/ThingDef[defName="Fallout_Razorgrain"]/plant/harvestedThingDef</xpath>
			   	    <value>
                 	    <harvestedThingDef>Fallout_RawRazorgrain</harvestedThingDef>
                	 </value>
               	</li>

		        <li Class="PatchOperationReplace">
			      	<xpath>/Defs/ThingDef[defName="Fallout_Razorgrain"]/plant/harvestYield</xpath>
			     	<value>
                   	    <harvestYield>18</harvestYield>
                  	</value>
                </li>

				<!-- Add Razorgrain to GrainToFlour and GrainToFlourBulk recipe ingredients -->
				<li Class="PatchOperationAdd"> 
					<xpath>/Defs/RecipeDef[defName="GAB_MakeFlour" or defName="GAB_MakeFlourBulk"]/ingredients/li/filter/thingDefs</xpath>
					<value>
						<li>Fallout_RawRazorgrain</li>
					</value>
				</li>
				<li Class="PatchOperationAdd"> 
					<xpath>/Defs/RecipeDef[defName="GAB_MakeFlour" or defName="GAB_MakeFlourBulk"]/fixedIngredientFilter/thingDefs</xpath>
					<value>
						<li>Fallout_RawRazorgrain</li>
					</value>
				</li>

			<!-- Pickle Fruit Recipe -->
				<li Class="PatchOperationAdd">
					<xpath>/Defs/RecipeDef[defName="GAB_PickleFruit"]/defaultIngredientFilter/thingDefs</xpath>
					<value>
						<li>Fallout_Mutfruit</li>
					</value>
				</li>

				<li Class="PatchOperationAdd">
					<xpath>/Defs/RecipeDef[defName="GAB_PickleFruit"]/fixedIngredientFilter/thingDefs</xpath>
					<value>
						<li>Fallout_Mutfruit</li>
					</value>
				</li>
				
				<li Class="PatchOperationAdd">
					<xpath>/Defs/RecipeDef[defName="GAB_PickleFruit"]/ingredients/li[0]/filter/thingDefs</xpath>
					<value>
						<li>Fallout_Mutfruit</li>
					</value>
				</li>

			<!-- Pickle Produce Recipe -->
				<li Class="PatchOperationAdd">
					<xpath>/Defs/RecipeDef[defName="GAB_PickleProduce"]/fixedIngredientFilter/disallowedThingDefs</xpath>
					<value>
						<li>Fallout_Mutfruit</li>
					</value>
				</li>

				<li Class="PatchOperationAdd">
					<xpath>/Defs/RecipeDef[defName="GAB_PickleProduce"]/defaultIngredientFilter/disallowedThingDefs</xpath>
					<value>
						<li>Fallout_Mutfruit</li>
					</value>
				</li>

            </operations>
		</match>
    </Operation>

</Patch>