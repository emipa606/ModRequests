<?xml version="1.0" encoding="utf-8" ?>
<Patch>
	<Operation Class="PatchOperationFindMod">
		<mods>
			<li>VGP Vegetable Garden</li>
		</mods> 
		<match Class="PatchOperationFindMod">
		<mods>
			<li>Vanilla Cooking Expanded</li>
		</mods> 
		<match Class="PatchOperationSequence">
			<operations>

				<!-- Prevent flour from being renamed to spelt flour -->
				<li Class="PatchOperationReplace"> 
					<xpath>/Defs/ThingDef[defName="VCE_Flour"]/label</xpath>
					<value>
						<label>flour</label>		
					</value>
				</li>

				<!-- Add Barley to GrainToFlour and GrainToFlourBulk recipe ingredients -->
				<li Class="PatchOperationAdd"> 
					<xpath>/Defs/RecipeDef[defName="GAB_MakeFlour" or defName="GAB_MakeFlourBulk"]/ingredients/li/filter/thingDefs</xpath>
					<value>
						<li>RawBarley</li>
					</value>
				</li>
				<li Class="PatchOperationAdd"> 
					<xpath>/Defs/RecipeDef[defName="GAB_MakeFlour" or defName="GAB_MakeFlourBulk"]/fixedIngredientFilter/thingDefs</xpath>
					<value>
						<li>RawBarley</li>
					</value>
				</li>
				</operations>
				</match>
				</match>
				</Operation>

	<Operation Class="PatchOperationFindMod">
		<mods>
			<li>VGP Vegetable Garden</li>
		</mods> 
		<match Class="PatchOperationSequence">
		<operations>
				<!-- Add mead to vinegar recipe -->
				<li Class="PatchOperationAdd">
					<xpath>/Defs/RecipeDef[defName="GAB_MakeVinegarMust"]/ingredients/li/filter/thingDefs</xpath>
					<value>
						<li>Mead</li>
					</value>
				</li>
				<li Class="PatchOperationAdd">
					<xpath>/Defs/RecipeDef[defName="GAB_MakeVinegarMust"]/fixedIngredientFilter/thingDefs</xpath>
					<value>
						<li>Mead</li>
					</value>
				</li>
				<li Class="PatchOperationAdd">
					<xpath>/Defs/RecipeDef[defName="GAB_MakeVinegarMust"]/defaultIngredientFilter/thingDefs</xpath>
					<value>
						<li>Mead</li>
					</value>
				</li>

			</operations>
		</match>
	</Operation>

	<Operation Class="PatchOperationFindMod">
		<mods>
			<li>VGP Vegetable Garden</li>
			<li>VGP Garden Drinks UF</li>
			<li>VGP More Veggies</li>
			<li>VGP Three Sisters Plants</li>			
			<li>【ZP】Rice cultivating civilization【1.1】</li>	
		</mods>
		<match Class="PatchOperationSequence">
			<operations>

				<!-- Add VGP fruit category to pickled fruit recipe -->
				<li Class="PatchOperationAdd">
					<xpath>/Defs/RecipeDef[defName="GAB_PickleFruit"]/defaultIngredientFilter/categories</xpath>
					<value>
						<li>FruitFoodRaw</li>
					</value>
				</li>

				<li Class="PatchOperationAdd">
					<xpath>/Defs/RecipeDef[defName="GAB_PickleFruit"]/fixedIngredientFilter/categories</xpath>
					<value>
						<li>FruitFoodRaw</li>
					</value>
				</li>
				
				<li Class="PatchOperationAdd">
					<xpath>/Defs/RecipeDef[defName="GAB_PickleFruit"]/ingredients/li/filter/categories</xpath>
					<value>
						<li>FruitFoodRaw</li>
					</value>
				</li>

				<!-- Prevent VGP fruit from being used in pickled produce recipe -->
				<li Class="PatchOperationAdd">
					<xpath>/Defs/RecipeDef[defName="GAB_PickleProduce"]/fixedIngredientFilter/disallowedCategories</xpath>
					<value>
						<li>FruitFoodRaw</li>
					</value>
				</li>

				<li Class="PatchOperationAdd">
					<xpath>/Defs/RecipeDef[defName="GAB_PickleProduce"]/defaultIngredientFilter/disallowedCategories</xpath>
					<value>
						<li>FruitFoodRaw</li>
					</value>
				</li>

				<!-- Allow pickled fruit to be used in VGP fruit recipes -->
				<li Class="PatchOperationAdd">
					<xpath>/Defs/ThingDef[defName="GAB_PickledFruit"]/thingCategories</xpath>
					<value>
						<li>FruitFoodRaw</li>
					</value>
				</li>

			</operations>
		</match>
	</Operation>
</Patch>

