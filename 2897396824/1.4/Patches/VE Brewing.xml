<?xml version="1.0" encoding="utf-8" ?>
<Patch>
	<Operation Class="PatchOperationFindMod">
		<mods>
			<li>Vanilla Brewing Expanded</li>
		</mods> 
		<match Class="PatchOperationSequence">
			<operations>

<!-- Baiju Patches -->

	<!-- Add VBE categories -->
	<li Class="PatchOperationConditional">
		<xpath>/Defs/ThingDef[defName="GAB_Baiju"]/thingCategories</xpath>
		<match Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="GAB_Baiju"]/thingCategories</xpath>
			<value>
				<li>VBE_DrinksSimpleSpirits</li>
			</value>
		</match>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="GAB_Baiju"]</xpath>
			<value>
				<thingCategories>
					<li>VBE_DrinksSimpleSpirits</li>
				</thingCategories>
			</value>
		</nomatch>
	</li>
	<li Class="PatchOperationConditional">
		<xpath>/Defs/ThingDef[defName="GAB_BaijuMash"]/thingCategories</xpath>
		<match Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="GAB_BaijuMash"]/thingCategories</xpath>
			<value>
				<li>VBE_Musts</li>
			</value>
		</match>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="GAB_Baiju"]</xpath>
			<value>
				<thingCategories>
					<li>VBE_Musts</li>
				</thingCategories>
			</value>
		</nomatch>
	</li>

	<!-- Add VBE Liquor Research -->
	<li Class="PatchOperationReplace">
		<xpath>/Defs/RecipeDef[defName="GAB_MakeBaijuMash"]/researchPrerequisite</xpath>
		<value>
			<researchPrerequisite>VBE_LiquorBrewing</researchPrerequisite>
		</value>
	</li>
	<li Class="PatchOperationReplace">
		<xpath>/Defs/ThingDef[defName="GAB_BaijuPot"]/researchPrerequisites</xpath>
		<value>
			<researchPrerequisites>
				<li>VBE_LiquorBrewing</li>
			</researchPrerequisites>
		</value>
	</li>

<!-- Raksi Patches -->
	
	<!-- VBE Categories -->
	<li Class="PatchOperationConditional">
		<xpath>/Defs/ThingDef[defName="GAB_Raksi"]/thingCategories</xpath>
		<match Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="GAB_Raksi"]/thingCategories</xpath>
			<value>
				<li>VBE_DrinksSimpleSpirits</li>
			</value>
		</match>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="GAB_Raksi"]</xpath>
			<value>
				<thingCategories>
					<li>VBE_DrinksSimpleSpirits</li>
				</thingCategories>
			</value>
		</nomatch>
	</li>
	<li Class="PatchOperationConditional">
		<xpath>/Defs/ThingDef[defName="GAB_RaksiMash"]/thingCategories</xpath>
		<match Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="GAB_RaksiMash"]/thingCategories</xpath>
			<value>
				<li>VBE_Musts</li>
			</value>
		</match>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="GAB_RaksiMash"]</xpath>
			<value>
				<thingCategories>
					<li>VBE_Musts</li>
				</thingCategories>
			</value>
		</nomatch>
	</li>

	<!-- Add VBE Liquor Research -->
	<li Class="PatchOperationReplace">
		<xpath>/Defs/RecipeDef[defName="GAB_MakeRaksiMash"]/researchPrerequisite</xpath>
		<value>
			<researchPrerequisite>VBE_LiquorBrewing</researchPrerequisite>
		</value>
	</li>
	<li Class="PatchOperationReplace">
		<xpath>/Defs/ThingDef[defName="GAB_RaksiStill"]/researchPrerequisites</xpath>
		<value>
			<researchPrerequisites>
				<li>VBE_LiquorBrewing</li>
			</researchPrerequisites>
		</value>
	</li>

<!-- Kvass Patches -->

	<!-- Add VBE categories -->
	<li Class="PatchOperationConditional">
		<xpath>/Defs/ThingDef[defName="GAB_Kvass"]/thingCategories</xpath>
		<match Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="GAB_Kvass"]/thingCategories</xpath>
			<value>
				<li>VBE_DrinksSimpleSpirits</li>
			</value>
		</match>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="GAB_Kvass"]</xpath>
			<value>
				<thingCategories>
					<li>VBE_DrinksSimpleSpirits</li>
				</thingCategories>
			</value>
		</nomatch>
	</li>
	<li Class="PatchOperationConditional">
		<xpath>/Defs/ThingDef[defName="GAB_UnfermentedKvass"]/thingCategories</xpath>
		<match Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="GAB_UnfermentedKvass"]/thingCategories</xpath>
			<value>
				<li>VBE_Musts</li>
			</value>
		</match>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="GAB_UnfermentedKvass"]</xpath>
			<value>
				<thingCategories>
					<li>VBE_Musts</li>
				</thingCategories>
			</value>
		</nomatch>
	</li>

<!-- Vinegar Patches -->

	<!-- Add VBE Categories -->
	<li Class="PatchOperationConditional">
		<xpath>/Defs/ThingDef[defName="GAB_VinegarMust"]/thingCategories</xpath>
		<match Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="GAB_VinegarMust"]/thingCategories</xpath>
			<value>
				<li>VBE_Musts</li>
			</value>
		</match>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="GAB_VinegarMust"]</xpath>
			<value>
				<thingCategories>
					<li>VBE_Musts</li>
				</thingCategories>
			</value>
		</nomatch>
	</li>

	<!-- Add VBE drinks to vinegar must recipe -->
	<li Class="PatchOperationAdd">
		<xpath>/Defs/RecipeDef[defName="GAB_MakeVinegarMust"]/ingredients/li/filter/categories</xpath>
		<value>
			<li>VBE_DrinksSimpleSpirits</li>
			<li>VBE_DrinksLuxurySpirits</li>
		</value>
	</li>
	<li Class="PatchOperationAdd">
		<xpath>/Defs/RecipeDef[defName="GAB_MakeVinegarMust"]/fixedIngredientFilter/categories</xpath>
		<value>
			<li>VBE_DrinksSimpleSpirits</li>
			<li>VBE_DrinksLuxurySpirits</li>
		</value>
	</li>
	<li Class="PatchOperationAdd">
		<xpath>/Defs/RecipeDef[defName="GAB_MakeVinegarMust"]/defaultIngredientFilter/categories</xpath>
		<value>
			<li>VBE_DrinksSimpleSpirits</li>
			<li>VBE_DrinksLuxurySpirits</li>
		</value>
	</li>

	<!-- But not all the drinks. You monster. Ambrandy and Double Whiskey not listed by default in vinegar must recipe. -->
	<li Class="PatchOperationAdd">
		<xpath>/Defs/RecipeDef[defName="GAB_MakeVinegarMust"]/defaultIngredientFilter/disallowedThingDefs</xpath>
		<value>
			<li>VBE_AmbrandyAwful</li>
			<li>VBE_AmbrandyPoor</li>
			<li>VBE_AmbrandyNormal</li>
			<li>VBE_AmbrandyGood</li>
			<li>VBE_AmbrandyExcellent</li>
			<li>VBE_AmbrandyMasterwork</li>
			<li>VBE_AmbrandyLegendary</li>
			<li>VBE_DoubleWhiskey</li>
		</value>
	</li>

<!-- Bar Recipe Patch -->
	<li Class="PatchOperationAdd">
		<xpath>/Defs/RecipeDef[defName="GAB_MakeBaijuMash" or defName="GAB_MakeRaksiMash" or defName="GAB_MakeUnfermentedKvass" or defName="GAB_MakeVinegarMust"]/recipeUsers</xpath>
		<value>
			<li>VBE_Bar</li>
		</value>
	</li>

<!-- Add drinks to cocktail recipes -->

	<li Class="PatchOperationAdd"> 
		<xpath>/Defs/RecipeDef[@Name = "VBE_CookCocktailMealBase"]/fixedIngredientFilter/thingDefs</xpath>
		<value>
			<li>GAB_Baiju</li>
			<li>GAB_Raksi</li>
			<li>GAB_Kvass</li>
		</value>
	</li>
	<li Class="PatchOperationAdd"> 
		<xpath>/Defs/RecipeDef[@Name = "VBE_CookCocktailMealBase"]/defaultIngredientFilter/thingDefs</xpath>
		<value>
			<li>GAB_Baiju</li>
			<li>GAB_Raksi</li>
			<li>GAB_Kvass</li>
		</value>
	</li>
	<li Class="PatchOperationAdd"> 
		<xpath>/Defs/RecipeDef[@Name = "VBE_CookCocktailFineMealBase"]/fixedIngredientFilter/thingDefs</xpath>
		<value>
			<li>GAB_Baiju</li>
			<li>GAB_Raksi</li>
			<li>GAB_Kvass</li>
		</value>
	</li>
	<li Class="PatchOperationAdd"> 
		<xpath>/Defs/RecipeDef[@Name = "VBE_CookCocktailFineMealBase"]/defaultIngredientFilter/thingDefs</xpath>
		<value>
			<li>GAB_Baiju</li>
			<li>GAB_Raksi</li>
			<li>GAB_Kvass</li>
		</value>
	</li>
				
	<li Class="PatchOperationAdd"> 
		<xpath>/Defs/RecipeDef[defName = "VBE_MakeCocktailFine"]/ingredients/li/filter/thingDefs</xpath>
		<value>
			<li>GAB_Baiju</li>
			<li>GAB_Raksi</li>
			<li>GAB_Kvass</li>
		</value>
	</li>

	<li Class="PatchOperationConditional">
		<xpath>/Defs/RecipeDef[defName = "VBE_MakeCocktailLavish"]/ingredients/li[1]/filter/thingDefs</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/RecipeDef[defName = "VBE_MakeCocktailLavish"]/ingredients/li[1]/filter</xpath>
			<value>
				<thingDefs>
					<li>GAB_Baiju</li>
					<li>GAB_Raksi</li>
					<li>GAB_Kvass</li>
				</thingDefs>
			</value>
		</nomatch>
		<match Class="PatchOperationAdd">
			<xpath>/Defs/RecipeDef[defName = "VBE_MakeCocktailLavish"]/ingredients/li[1]/filter/thingDefs</xpath>
			<value>
				<li>GAB_Baiju</li>
				<li>GAB_Raksi</li>
				<li>GAB_Kvass</li>
			</value>
		</match>
	</li>

			</operations>
		</match>
	</Operation>
</Patch>

