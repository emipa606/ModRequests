<?xml version="1.0" encoding="utf-8" ?>
<Defs>
  
    <AbilityDef>
    <defName>REDS_Invisibility</defName>
    <label>ethereal</label>
    <description>Phase shift to an ethereal form and turn invisible. Harm to the ethereal form will momentarily disrupt their invisibility.</description>
    <warmupMote>REDS_Mote_SmallSpellWarmup</warmupMote>
    <warmupSound>REDS_SpiritAbility_Cast</warmupSound>
    <stunTargetWhileCasting>True</stunTargetWhileCasting>
    <showPsycastEffects>False</showPsycastEffects>
    <moteOffsetAmountTowardsTarget>0.5</moteOffsetAmountTowardsTarget>
    <iconPath>UI/Abilities/SpiritInvisibility</iconPath>
	<displayGizmoWhileUndrafted>true</displayGizmoWhileUndrafted>
	<disableGizmoWhileUndrafted>false</disableGizmoWhileUndrafted>		
    <cooldownTicksRange>2500</cooldownTicksRange> 
    <writeCombatLog>True</writeCombatLog>
    <hotKey>Misc12</hotKey>
    <targetRequired>false</targetRequired>
    <casterMustBeCapableOfViolence>false</casterMustBeCapableOfViolence>
    <verbProperties>
      <verbClass>Verb_CastAbility</verbClass>
      <drawAimPie>false</drawAimPie>
      <requireLineOfSight>false</requireLineOfSight>
      <nonInterruptingSelfCast>true</nonInterruptingSelfCast>
      <warmupTime>1.7</warmupTime>
      <range>19.9</range>
      <targetable>false</targetable>
      <targetParams>
        <canTargetSelf>True</canTargetSelf>
      </targetParams>
    </verbProperties>
    <comps>
      <li Class="CompProperties_AbilityGiveHediff">
        <compClass>CompAbilityEffect_GiveHediff</compClass>
        <hediffDef>REDS_SpiritInvisibility</hediffDef>
      </li> 
      <li Class="CompProperties_AbilityFleckOnTarget">
        <fleckDef>PsycastPsychicEffect</fleckDef>
      </li>
      <li Class="REDSpirit.CompProperties_EtherealForm">

      </li>	  
    </comps>
  </AbilityDef>
  
      <AbilityDef>
    <defName>REDS_InvisibilityOff</defName>
    <label>corporeal</label>
    <description>Phase shift to a corporeal form and materialize. If the corporeal form is destroyed, the spirit will forcibly skip back to their pocket dimension.</description>
    <warmupMote>REDS_Mote_SmallSpellWarmup</warmupMote>
    <warmupSound>REDS_SpiritAbility_Cast</warmupSound>
    <stunTargetWhileCasting>True</stunTargetWhileCasting>
    <showPsycastEffects>False</showPsycastEffects>
    <moteOffsetAmountTowardsTarget>0.5</moteOffsetAmountTowardsTarget>
    <iconPath>UI/Abilities/SpiritInvisibilityOff</iconPath>
	<displayGizmoWhileUndrafted>true</displayGizmoWhileUndrafted>
	<disableGizmoWhileUndrafted>false</disableGizmoWhileUndrafted>	
    <cooldownTicksRange>2500</cooldownTicksRange> 
    <writeCombatLog>True</writeCombatLog>
    <hotKey>Misc12</hotKey>
    <targetRequired>false</targetRequired>
    <casterMustBeCapableOfViolence>false</casterMustBeCapableOfViolence>
    <verbProperties>
      <verbClass>Verb_CastAbility</verbClass>
      <drawAimPie>false</drawAimPie>
      <requireLineOfSight>false</requireLineOfSight>
      <nonInterruptingSelfCast>true</nonInterruptingSelfCast>
      <warmupTime>1.7</warmupTime>
      <range>19.9</range>
      <targetable>false</targetable>
      <targetParams>
        <canTargetSelf>True</canTargetSelf>
      </targetParams>
    </verbProperties>
    <comps>
      <li Class="REDSpirit.CompProperties_AbilityEctoplasmCost">
        <hemogenCost>0.2</hemogenCost>
      </li>	
      <li Class="CompProperties_AbilityGiveHediff">
        <compClass>CompAbilityEffect_GiveHediff</compClass>
        <hediffDef>REDS_SpiritInvisibilityOff</hediffDef>
      </li> 
      <li Class="CompProperties_AbilityFleckOnTarget">
        <fleckDef>PsycastPsychicEffect</fleckDef>
      </li>
    </comps>
  </AbilityDef>
  
	<AbilityDef>
		<defName>REDS_Ability_SerenityEmbrace</defName>
		<label>serenity's embrace</label>
		<description>Embrace the target and psychically transfer serene thoughts. Works on animals or humans.</description>
		<warmupMote>REDS_Mote_SmallSpellWarmup</warmupMote>
		<warmupSound>REDS_Peace_Cast</warmupSound>
		<showPsycastEffects>False</showPsycastEffects>
		<moteOffsetAmountTowardsTarget>0.5</moteOffsetAmountTowardsTarget>		
		<stunTargetWhileCasting>True</stunTargetWhileCasting>		
		<iconPath>UI/Abilities/SerenityEmbrace</iconPath>
		<displayGizmoWhileUndrafted>true</displayGizmoWhileUndrafted>
		<disableGizmoWhileUndrafted>false</disableGizmoWhileUndrafted>
		<casterMustBeCapableOfViolence>false</casterMustBeCapableOfViolence>
		<jobDef>CastAbilityOnThingMelee</jobDef>
		<!--<category>Sanguophage</category>-->
		<displayOrder>600</displayOrder>
		<verbProperties>
			<verbClass>Verb_CastAbilityTouch</verbClass>
			<drawAimPie>false</drawAimPie>
			<range>-1</range>
			<warmupTime>6</warmupTime>
			<violent>false</violent>
			<targetParams>
				<canTargetAnimals>true</canTargetAnimals>
				<canTargetSelf>false</canTargetSelf>
				<canTargetBuildings>false</canTargetBuildings>
				<canTargetMechs>false</canTargetMechs>
			</targetParams>
		</verbProperties>
		<comps>
			<li Class="REDSpirit.CompProperties_AbilityEctoplasmCost">
				<hemogenCost>0.5</hemogenCost>
			</li>
			<li Class="REDSpirit.CompProperties_AbilitySerenityEmbrace">
			
			</li>
			<li Class="CompProperties_AbilityFleckOnTarget">
				<fleckDef>PsycastPsychicEffect</fleckDef>
			</li>
			  <li Class="CompProperties_AbilitySocialInteraction">
				<interactionDef>SerenityEmbrace</interactionDef>
				<canApplyToMentallyBroken>True</canApplyToMentallyBroken>
				<canApplyToAsleep>true</canApplyToAsleep>
				<canApplyToUnconscious>true</canApplyToUnconscious>
			  </li>
		</comps>
	</AbilityDef>

  <AbilityDef>
    <defName>REDS_Haunt</defName>
    <label>haunt</label>
    <description>Psychically haunt a person, causing them to flee in terror.</description>
    <iconPath>UI/Abilities/Haunt</iconPath>
    <cooldownTicksRange>7500</cooldownTicksRange> <!-- 3 hours -->
    <warmupEffecter>REDS_SpiritSpell_Warmup</warmupEffecter>
    <stunTargetWhileCasting>true</stunTargetWhileCasting>	
    <sendMessageOnCooldownComplete>true</sendMessageOnCooldownComplete>
    <writeCombatLog>true</writeCombatLog>
    <charges>3</charges>
    <cooldownPerCharge>true</cooldownPerCharge>
    <casterMustBeCapableOfViolence>false</casterMustBeCapableOfViolence>
	<jobDef>CastAbilityOnThingMelee</jobDef>	
    <verbProperties>
	  <verbClass>Verb_CastAbilityTouch</verbClass>
      <warmupTime>1</warmupTime>
      <range>-1</range>
      <drawAimPie>false</drawAimPie>
      <soundCast>REDS_Haunt_Cast</soundCast>
      <targetParams>
        <canTargetLocations>false</canTargetLocations>
        <canTargetPawns>true</canTargetPawns>
        <canTargetAnimals>false</canTargetAnimals>
        <canTargetBuildings>false</canTargetBuildings>
        <canTargetHumans>true</canTargetHumans>
        <canTargetMechs>false</canTargetMechs>
        <canTargetSelf>false</canTargetSelf>
        <canTargetMutants>false</canTargetMutants>
        <neverTargetIncapacitated>true</neverTargetIncapacitated>
      </targetParams>
    </verbProperties>
    <comps>
		<li Class="REDSpirit.CompProperties_AbilityEctoplasmCost">
			<hemogenCost>0.1</hemogenCost>
		</li>	
      <li Class="CompProperties_AbilityGiveMentalState">
        <compClass>CompAbilityEffect_GiveMentalState</compClass>
        <stateDef>Haunted</stateDef>
    <!--    <goodwillImpact>-25</goodwillImpact> -->
        <forced>true</forced>
      </li>
      <li Class="CompProperties_AbilityConnectingFleckLine">
        <fleckDef>PsycastPsychicLine</fleckDef>
      </li>
      <li Class="CompProperties_AbilityEffecterOnTarget">
        <effecterDef>REDS_Haunt_Target</effecterDef>
      </li>
    </comps>
  </AbilityDef>
  
   <AbilityDef ParentName="AbilityTouchBase">
    <defName>REDS_SpiritualHealing</defName>
    <label>spiritual healing</label>
    <description>Use ectoplasm to heal someone. The process will stop bleeding, restore blood loss, and can even heal significant injuries.</description>
    <iconPath>UI/Abilities/SpiritualHealing</iconPath>
    <cooldownTicksRange>360000</cooldownTicksRange> <!-- 6 days -->
    <showPsycastEffects>false</showPsycastEffects>
    <sendMessageOnCooldownComplete>true</sendMessageOnCooldownComplete>
    <stunTargetWhileCasting>true</stunTargetWhileCasting>
    <moteOffsetAmountTowardsTarget>0.5</moteOffsetAmountTowardsTarget>
    <displayGizmoWhileUndrafted>true</displayGizmoWhileUndrafted>
    <disableGizmoWhileUndrafted>false</disableGizmoWhileUndrafted>
    <warmupMote>REDS_Mote_SmallSpellWarmup</warmupMote>
    <warmupEffecter>REDS_AbilityCasting</warmupEffecter>
    <warmupSound>REDS_Healing_Cast</warmupSound>
    <hostile>false</hostile>
    <casterMustBeCapableOfViolence>false</casterMustBeCapableOfViolence>
    <verbProperties>
      <verbClass>Verb_CastAbilityTouch</verbClass>
      <drawAimPie>false</drawAimPie>
      <range>-1</range>
      <warmupTime>6</warmupTime>
      <targetParams>
        <canTargetSelf>false</canTargetSelf>
        <canTargetMechs>false</canTargetMechs>
        <canTargetBuildings>false</canTargetBuildings>
      </targetParams>
    </verbProperties>
    <comps>
		<li Class="REDSpirit.CompProperties_AbilityEctoplasmCost">
			<hemogenCost>0.9</hemogenCost>
		</li>		
      <li Class="REDSpirit.CompProperties_SpiritualHealing" />
      <li Class="CompProperties_AbilityFleckOnTarget">
        <fleckDef>REDS_SpiritHealing</fleckDef>
      </li>
    </comps>
  </AbilityDef> 

</Defs>