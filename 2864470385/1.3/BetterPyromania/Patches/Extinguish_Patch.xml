<?xml version="1.0" encoding="utf-8" ?>
<Patch>
<!-- vanilla -->
  <Operation Class="PatchOperationAdd">
    <order>Prepend</order>
    <xpath>Defs/ThingDef[defName="Campfire" or defName="TorchLamp"]/comps</xpath>
    <value>
      <li Class="CompProperties_Flickable" />
    </value>
  </Operation>
  <Operation Class="PatchOperationAttributeSet">
    <xpath>Defs/ThingDef[defName="Campfire" or defName="TorchLamp"]/comps/li[@Class="CompProperties_FireOverlay"]</xpath>
    <value>MaliExtinguishRefuelables.CompProperties_FireOverlayExtinguishable</value>
    <attribute>Class</attribute>
  </Operation>
 <!-- dlc -->
  <Operation Class="PatchOperationAdd" MayRequire="Ludeon.RimWorld.Royalty">
    <order>Prepend</order>
    <xpath>Defs/ThingDef[defName="Brazier"]/comps</xpath>
    <value>
      <li Class="CompProperties_Flickable" />
    </value>
  </Operation>
  <Operation Class="PatchOperationAttributeSet" MayRequire="Ludeon.RimWorld.Royalty">
    <xpath>Defs/ThingDef[defName="Brazier"]/comps/li[@Class="CompProperties_FireOverlay"]</xpath>
    <value>MaliExtinguishRefuelables.CompProperties_FireOverlayExtinguishable</value>
    <attribute>Class</attribute>
  </Operation>
  
  <Operation Class="PatchOperationAdd" MayRequire="Ludeon.RimWorld.Royalty,Ludeon.RimWorld.Ideology">
    <order>Prepend</order>
    <xpath>Defs/ThingDef[defName="DarklightBrazier"]/comps</xpath>
    <value>
      <li Class="CompProperties_Flickable" />
    </value>
  </Operation>
  <Operation Class="PatchOperationAttributeSet" MayRequire="Ludeon.RimWorld.Royalty,Ludeon.RimWorld.Ideology">
    <xpath>Defs/ThingDef[defName="DarklightBrazier"]/comps/li[@Class="CompProperties_FireOverlay"]</xpath>
    <value>MaliExtinguishRefuelables.CompProperties_FireOverlayExtinguishable</value>
    <attribute>Class</attribute>
  </Operation>
  
  <Operation Class="PatchOperationAdd" MayRequire="Ludeon.RimWorld.Ideology">
    <order>Prepend</order>
    <xpath>Defs/ThingDef[defName="Darktorch" or defName="DarktorchFungus"]/comps</xpath>
    <value>
      <li Class="CompProperties_Flickable" />
    </value>
  </Operation>
  <Operation Class="PatchOperationAttributeSet" MayRequire="Ludeon.RimWorld.Ideology">
    <xpath>Defs/ThingDef[defName="Darktorch" or defName="DarktorchFungus"]/comps/li[@Class="CompProperties_FireOverlay"]</xpath>
    <value>MaliExtinguishRefuelables.CompProperties_FireOverlayExtinguishable</value>
    <attribute>Class</attribute>
  </Operation>

  
 <!-- VE -->
  <Operation Class="PatchOperationFindMod">
    <mods>
      <li>Vanilla Furniture Expanded</li>
    </mods>
	<match Class="PatchOperationSequence">
       <operations>
	    <li Class="PatchOperationAdd">
			<order>Prepend</order>
			<xpath>Defs/ThingDef[defName="Stone_Campfire"]/comps</xpath>
			<value>
			  <li Class="CompProperties_Flickable" />
			</value>
		</li>
		<li Class="PatchOperationAttributeSet">
			<xpath>Defs/ThingDef[defName="Stone_Campfire"]/comps/li[@Class="CompProperties_FireOverlay"]</xpath>
			<value>MaliExtinguishRefuelables.CompProperties_FireOverlayExtinguishable</value>
			<attribute>Class</attribute>
		</li>
	  </operations>
    </match>
  </Operation>
  
  <!-- smokepit -->
  <Operation Class="PatchOperationFindMod">
    <mods>
      <li>Smoked meat</li>
    </mods>
	<match Class="PatchOperationSequence">
       <operations>
	    <li Class="PatchOperationAdd">
			<order>Prepend</order>
			<xpath>Defs/ThingDef[defName="Smokepit"]/comps</xpath>
			<value>
			  <li Class="CompProperties_Flickable" />
			</value>
		</li>
		<li Class="PatchOperationAttributeSet">
			<xpath>Defs/ThingDef[defName="Smokepit"]/comps/li[@Class="CompProperties_FireOverlay"]</xpath>
			<value>MaliExtinguishRefuelables.CompProperties_FireOverlayExtinguishable</value>
			<attribute>Class</attribute>
		</li>
	  </operations>
    </match>
  </Operation>
  
  <!-- MLH -->
  <Operation Class="PatchOperationFindMod">
    <mods>
      <li>Medieval Lighting and Heat</li>
    </mods>
	<match Class="PatchOperationSequence">
       <operations>
	    <li Class="PatchOperationRemove"> <!-- gotta remove original authors attempt at flickable first -->
			<xpath>Defs/ThingDef[defName="MLH_Bonfire"]/comps/li[@Class="CompProperties_Flickable"]</xpath>
		</li>
	    <li Class="PatchOperationAdd"><!-- then we readd it properly -->
			<order>Prepend</order>
			<xpath>Defs/ThingDef[defName="MLH_Bonfire" or defName="MLH_Lantern"]/comps</xpath>
			<value>
			  <li Class="CompProperties_Flickable" />
			</value>
		</li>
		<li Class="PatchOperationAttributeSet">
			<xpath>Defs/ThingDef[defName="MLH_Bonfire" or defName="MLH_Lantern"]/comps/li[@Class="CompProperties_FireOverlay"]</xpath>
			<value>MaliExtinguishRefuelables.CompProperties_FireOverlayExtinguishable</value>
			<attribute>Class</attribute>
		</li>
	  </operations>
    </match>
  </Operation>
  
</Patch>